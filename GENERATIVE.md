PROYECTO GEMELO BIZARRO: CONTEXTO GENERATIVO Y TÉCNICOEste documento sirve como "Memoria del Proyecto" para Agentes de IA. Úsalo como contexto para entender la arquitectura, las restricciones y el estilo de código antes de proponer cambios o nuevas funcionalidades.1. PRINCIPIOS FUNDAMENTALES (THE PRIME DIRECTIVES)Inversión Lógica: El agente NUNCA debe estar de acuerdo con el TARGET_HOST. Debe buscar la antítesis filosófica, lógica o emocional.Persistencia Emocional: El agente no reinicia su personalidad en cada ejecución. Su estado de ánimo (mood) persiste en PostgreSQL y decae con el tiempo (decay_factor).OpSec (Seguridad Operativa): Prioridad absoluta a evitar la detección de X (Twitter). Uso de Jitter (retrasos aleatorios), cookies pre-autenticadas y límites de tasa estrictos.Arquitectura Híbrida: * Razonamiento: DeepSeek R1 (API).Embeddings: OpenAI (API) -> Compatibilidad estricta de 1536 dimensiones.2. MAPA DE MÓDULOS (src/)src/core/ (Infraestructura)database.py: Singleton de conexión SQLAlchemy. Maneja pool_pre_ping=True.models.py: Definiciones ORM.SemanticMemory: Tabla vectorial (embedding vector(1536), índice HNSW).InteractionLog: Historial de acciones y recompensas.MoodLog: Snapshots del estado emocional (Valence/Arousal).src/modules/ (Lógica de Negocio)cognitive.py: Wrapper de DeepSeek. Contiene el SYSTEM_PROMPT crítico. Maneja la limpieza de JSONs de respuesta.memory_service.py: Wrapper de OpenAI para embeddings. CRÍTICO: Mantiene la coherencia de dimensiones (1536) entre la API y la DB. Implementa búsqueda por distancia de coseno.mood_engine.py: Modelo Russell de afecto (Valence-Arousal). Implementa la lógica de decaimiento temporal y traducción de coordenadas numéricas a instrucciones de texto ("Eufórico", "Depresivo").x_client.py: Wrapper de twikit. Maneja cookies (cookies.json), reintentos (tenacity) y lógica de "Login Silencioso".Raízmain.py: Bucle infinito asíncrono.Secuencia: Escanear -> Verificar DB -> Consultar Mood -> RAG -> DeepSeek -> Publicar -> Dormir.Implementa lógica probabilística para Quote Tweets (1/6 de probabilidad).3. ESQUEMA DE DATOS (Referencia Rápida)-- Semantic Memory
TABLE semantic_memory (
    id SERIAL PRIMARY KEY,
    content TEXT,
    embedding VECTOR(1536), -- OpenAI Ada-002/Small compatible
    source_type VARCHAR,    -- 'host_tweet', 'self_reflection'
    metadata JSONB
);

-- Mood State
TABLE mood_logs (
    valence FLOAT, -- Range: -1.0 to 1.0
    arousal FLOAT  -- Range: -1.0 to 1.0
);
4. CONVENCIONES DE CÓDIGOAsincronía: Todo lo relacionado con I/O de red (x_client, main_loop) debe ser async/await.Base de Datos: Uso de sesiones efímeras (get_db_session generator). Nunca dejar sesiones abiertas en el bucle global.Variables de Entorno: NUNCA hardcodear credenciales. Usar os.getenv con dotenv.Manejo de Errores: El bucle principal (main.py) NUNCA debe crashear. Capturar Exception genérica, loguear y continuar/dormir.5. HOJA DE RUTA Y DEUDA TÉCNICATODO: Implementar sistema de Rewards real (verificar likes/replies 24h después y actualizar InteractionLog).TODO: Añadir capacidad de generar imágenes (Flux/Stable Diffusion) basadas en el estado emocional.FIXME: Dependencia crítica de cookies.json. Implementar un mecanismo de alerta si las cookies expiran (actualmente solo loguea error).